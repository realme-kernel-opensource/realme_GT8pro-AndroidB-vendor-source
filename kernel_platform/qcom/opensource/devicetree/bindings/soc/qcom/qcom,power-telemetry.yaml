# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/soc/qcom/qcom,power-telemetry.yaml#"
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Qualcomm Technologies, Inc. Power Telemetry device

maintainers:
  - Manaf Meethalavalappu Pallikunhi <quic_manafm@quicinc.com>

description: |
  Qualcomm Technologies, Inc. Power Telemetry(QPT) device enables to
  measure different pmic regulator power consumption data. It exposes
  these data to userspace clients via powercap sysfs interface via
  Qualcomm Technologies, Inc. Power Telemetry framework.

properties:
  compatible:
    const: qcom,power-telemetry-device

  nvmem-names:
    description: |
      Array of nvmem device name(s) for QPT data.
    items:
      - const: qpt-config-sdam
      - const: qpt-frac-sdam
      - const: qpt-data-sdam
    $ref: /schemas/types.yaml#/definitions/string-array

  nvmem:
    minItems: 3
    description: |
      Array of phandles of the nvmem device(s) for QPT data.

  interrupts:
    maxItems: 2
    description: |
      Specifies the interrupts for QPT data ready IRQ and buffer overflow IRQ.

  bob-channels:
    minItems: 1
    description: |
      Array of ppids for epm based bob regulator channels that
      QPT device going to measure.
    $ref: /schemas/types.yaml#/definitions/phandle-array

  power-domains:
    maxItems: 1

  "#powerzone-cells":
    const: 1
    description: |
      Number of cells required to uniquely identify the power zones. Since
      we have multiple power zone channels this is set to 1.

required:
  - compatible
  - interrupts
  - nvmem-names
  - nvmem
  - power-domains

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>

    qcom,power-telemetry-device {
        compatible = "qcom,power-telemetry";
        interrupts = <0x0 0xa2 0x1 IRQ_TYPE_EDGE_RISING>,
                        <0x0 0xa1 0x1 IRQ_TYPE_EDGE_RISING>;
        nvmem = <&pmk8850_sdam_49>, <&pmk8850_sdam_50>, <&pmk8850_sdam_51>;
        nvmem-names = "qpt-config-sdam", "qpt-frac-sdam", "qpt-data-sdam";
        power-domains = <&CLUSTER_PD>;
        bob-channels = <0x100 0x110>;
        #powerzone-cells = <1>;
    };
